.block--nav-main {

  $color-toggle-bg: palette(secondary, base);
  $color-toggle-fg: palette(white, pure);

  $color-link-bg: palette(primary, base);
  $color-link-fg: #fff;
  $color-link-border: palette(primary, dark);

  $color-child-bg: palette(primary, dark);

  $padding-link: 10px 20px;
  $padding-left: 60px; // for JS menu

  order: -1;

  .block__title {
    padding: $padding-link;
    background: $color-toggle-bg;
    color: $color-toggle-fg;
    font-size: inherit;
    margin-bottom: 0;
  }
  .menu-block-wrapper {
    a, .nolink {
      padding: $padding-link;
      background: $color-link-bg;
      color: $color-link-fg;
      border-bottom: 1px solid $color-link-border;
    }
    .nolink {
      display: block;
    }
  }
  .menu {
    .menu {
      display: none;
    }
  }
  &.menu-processed {
    .block__title {
      text-align: right;
      cursor: pointer;
      &:after {
        @include faicon("\F0C9");
        margin-left: .5em;
      }
    }
    .block__content {
      display: none;
    }
    .expanded,
    .leaf {
      position: relative;
      a:first-child,
      .nolink {
        padding-left: $padding-left;
      }
      .menu {
        a, .nolink {
          background: $color-child-bg;
        }
        .menu-child-toggle {
          background: none;
        }
        > li > .menu > li > a,
        > li > .menu > li > .nolink {
          padding-left: $padding-left + 20px;
        }
      }
    }
    .menu > li.expanded > a:first-child { //background for first level arrows
      &:before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: 46px;
        height: 100%;
        background: $color-child-bg;
      }
    }
    .menu-child-toggle {
      position: absolute;
      top: 0;
      left: 0;
      font-size: 0;
      background: none;
      border-bottom: none;
      &:after {
        @include faicon("\F105");
        font-size: 1rem;
      }
      &.open {
        transform: rotate(90deg);
      }
    }
  }
  @include breakpoint($tab) {
    transition: transform .5s;
    transform: translateX(100%);
    position: absolute;
    right: 0;
    top: 0;
    z-index: 52;
    width: 50%;
    &.open {
      transform: translateX(0);
    }
    .block__content {
      display: block !important; // override js
      height: auto !important; //override js
    }
    &.menu-processed {
      .block__title {
        &:after {
          @include faicon($fa-var-times);
        }
      }
    }
  }
  @include breakpoint($nav) {

    $color-link-bg: palette(white, pure);
    $color-link-bg-hover: palette(white, pure);
    $color-link-fg: palette(black, base);
    $color-link-fg-hover: palette(black, pure);
    $color-link-drop: palette(primary, base);
    $color-link-drop-hover: palette(primary, dark);

    $color-child-border: palette(primary, base); // color of top border of 2nd level menu
    $border-width: 3px;

    $color-child-bg: palette(white, pure);
    $color-child-bg-hover: palette(primary, base);
    $color-child-fg: palette(neutral, xanadu);
    $color-child-fg-hover: palette(white, pure);

    $color-third-bg: palette(primary, base);
    $color-third-bg-hover: palette(primary, dark);
    $color-third-fg: $color-child-bg;
    $color-third-fg-hover: $color-child-fg-hover;
    $color-third-border: $color-child-border;

    $padding-link-top: 5px; // top padding of 1st level menu items

    order: 0;

    transition: transform .5s;
    transform: translateX(0);
    position: static;
    z-index: 52;
    width: auto;
    .block__title {
      display: none;
    }
    .block__content {
      display: block !important; // override js
    }
    .menu-block-wrapper {
      a {
        background: $color-link-bg;
        color: $color-link-fg;
      }
      a, .nolink {
        border: 0;
      }
      > .menu { // first level
        @include flexbox;
        position: relative;
        > li > a {
          text-transform: uppercase;
          font-weight: 600;
          &:first-child {
            padding-top: $padding-link-top;
          }
        }
        > li.expanded > a {
          &:after {
            @include faicon("\F107");
            margin-left: 10px;
            color: $color-link-drop;
          }
          &:first-child {
            &:before {
              content: none;
            }
          }
        }
        > li:hover > a {
          background: $color-link-bg-hover;
          color: $color-link-fg-hover;
          &:after {
            color: $color-link-drop-hover;
          }
        }
      }
      > .menu > li:hover > .menu { // second level
        display: block !important; // override JS
        position: absolute;
        min-width: 180px;
        z-index: 52;
        border-top: $border-width solid $color-child-border;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        text-transform: uppercase;
        font-weight: 600;
        > li > a {
          background: $color-child-bg;
          color: $color-child-fg;
          white-space: nowrap;
          &:hover,
          &.active,
          &.active-trail {
            background: $color-child-bg-hover;
            color: $color-child-fg-hover;
          }
        }
        > li > .nolink {
          background: $color-child-bg;
          color: $color-child-fg;
          white-space: nowrap;
          padding: $padding-link;
          &:hover {
            background: $color-child-bg-hover;
            color: $color-child-fg-hover;
          }
        }
        > li:hover > a,
        > li:hover > .nolink {
          background: $color-child-bg-hover;
          color: $color-child-fg-hover;
        }
      }
      > .menu > li:last-child:hover > .menu {
        right: 0;
      }
      > .menu > li > .menu > li:hover > .menu { // third level
        display: block !important; // overide js
        position: absolute;
        left: 100%;
        top: 0;
        // border-top: $border-width solid $color-third-border;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
        z-index: 52;
        > li > a {
          white-space: nowrap;
          background: $color-third-bg;
          color: $color-third-fg;
          padding: $padding-link;
          &:hover,
          &.active {
            background: $color-third-bg-hover;
            color: $color-third-fg-hover;
          }
        }
        > li > .nolink {
          white-space: nowrap;
          background: $color-third-bg;
          color: $color-third-fg;
          padding: $padding-link;
        }
      }
      > .menu > li > .menu > li.first:hover > .menu {
        border-top: $border-width solid $color-third-border;
        top: -$border-width;
      }
      > .menu > li:last-child > .menu > li:hover > .menu {
        right: 100%;
        left: auto;
      }
    }
    &.menu-processed {
      .menu-child-toggle {
        display: none;
      }
      .expanded,
      .leaf {
        a:first-child {
          padding: $padding-link;
        }
      }
    }
  }
}
